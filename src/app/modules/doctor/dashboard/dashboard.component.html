<div class="container pt-5">
    <div class="row">
        <div class="col">


            <div class="row">
                <div class="col-md-7">
                    <mat-card class="card">

                        <div class="row">
                            <div class="col-7">
                                <h2 class="text-nowrap ">
                                    {{gretting_msg}}, <span class="doc_name"> {{doctor_data?.doctor_name}} </span>
                                </h2>
                                <p>Have a nice day</p>

                            </div>
                            <div class="col-5">

                                <div class="doc_logo">
                                    <img src="../../../../assets/images/publicdomainq-doc2.svg" height="150" alt=""
                                        srcset="">
                                </div>

                            </div>
                        </div>
                    </mat-card>
                </div>

                <div class="col">
                    <div class="row">
                        <div class="col-6">
                            <mat-card  class="card card-2">
                                <p>Total Appoinment</p>
                                <h2>{{patient_list.length}}</h2>
                            </mat-card >
                        </div>
                        <div class="col-6">
                            <mat-card  class="card card-3">
                                <p>Appoinment Cancelled</p>
                                <h2>{{cancelled_appoinment}}</h2>
                            </mat-card >
                        </div>
                    </div>
                </div>


            </div>

            <div class="mh-300">

                <div class="row pt-3">
                    <div class="row">
                        <div class="col">
                            <div class="forms-group monthSelect pb-3">
                                <input type="month" [ngModel]="selectDate" (change)="getdata($event)" name="" id="">
                            </div>
                        </div>
                    </div>
                    <div class="col ">

                        <div class="row">
                            <div class="col-2">
                                <h5>Date</h5>
                            </div>
                            <div class="col-10">
                                <div class="row">
                                    <div class="col">
                                        <h5>Name</h5>
                                    </div>
                                    <div class="col">
                                        <h5>Status</h5>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <ng-container *ngFor="let g of grouped_data">
                            <div class="row list1 ">
                                <div class="col-2">
                                    {{g.date | date:'dd/MM/yy'}}

                                </div>
                                <div class="col-10">
                                    <div *ngFor="let app of g.apps">



                                        <div class="row">
                                            <div class="col">
                                                {{app.patient_name}}
                                            </div>
                                            <div class="col">
                                                {{app.appointment_status}}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- <br> -->

                        </ng-container>


                    </div>
                    <div class="col-1"></div>
                    <div class="col">

                        <div class="row ">
                            <div class="col-2">
                                <h5>Date</h5>
                            </div>
                            <div class="col-10">
                                <div class="row text-center">
                                    <div class="col">
                                        <h5>Total</h5>
                                    </div>
                                    <div class="col">
                                        <h5> Closed </h5>
                                    </div>
                                    <div class="col">
                                        <h5> Cancelled </h5>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <ng-container *ngFor="let g of grouped_data">
                            <div class="row list1">
                                <div class="col-2">
                                    {{g.date | date:'dd/MM/yy'}}

                                </div>
                                <div class="col-10">



                                    <div class="row text-center">
                                        <div class="col">
                                            {{g.apps.length}}
                                        </div>
                                        <div class="col">
                                            {{g.closed}}
                                        </div>
                                        <div class="col">
                                            {{g.Cancelled}}
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- <br> -->

                        </ng-container>


                    </div>
                </div>
                <div *ngIf="grouped_data && grouped_data.length == 0" class="row">
                    <div class="col text-center">
                        <img src="../../../../assets//images/noRecordFound.svg" alt="" srcset="">
                    </div>
                </div>
            </div>

            <div class="row pt-2">

                <div class="col">

                    <!-- <table class="table">

                        <thead>
                            <th scope="col">No.</th>
                            <th scope="col">Patient Name</th>
                            <th scope="col">Patient Phone</th>
                            <th scope="col">Appointment Date</th>
                            <th scope="col">Appointment Time</th>
                            <th scope="col">Status</th>
                        </thead>
                        <tbody>
                            <tr *ngFor="let p of patient_list;let i = index">
                                <td scope="row">{{i+1}}</td>
                                <td style="position: relative;"><img class="patient_img" height="30"
                                        src="https://img.icons8.com/external-konkapp-outline-color-konkapp/64/000000/external-patient-virus-transmission-konkapp-outline-color-konkapp.png" />

                                    {{p.patient_name}}</td>
                                <td>{{p.patinet_phone}}</td>
                                <td>{{p.appointment_date | date:'dd/MM/yy'}}</td>
                                <td>{{p.appointment_time}}</td>
                                <td>
                                    <div class="row">
                                        <div class="col-4">
                                            <span class="w-100">

                                                {{p.appointment_status}}
                                            </span>

                                        </div>
                                        <div *ngIf="p.appointment_status == 'Open'" class="col">

                                            <a class="dropdown-toggle" role="button" id="dropdownMenuLink"
                                                [matMenuTriggerFor]="menu">

                                            </a>
                                            <mat-menu #menu="matMenu">
                                                <button mat-menu-item
                                                    (click)="updateStatus(p._id,'Closed')">Close</button>
                                                <button mat-menu-item
                                                    (click)="updateStatus(p._id,'Cancelled')">Cancel</button>
                                            </mat-menu>
                                        </div>
                                    </div>


                                </td>
                            </tr>

                        </tbody>

                    </table> -->
                    <table mat-table [dataSource]="dataSource" class="mat-elevation-z8 w-100">


                        <!-- Position Column -->
                        <ng-container matColumnDef="position">
                            <th mat-header-cell *matHeaderCellDef class="f-18"> No. </th>
                            <td mat-cell *matCellDef="let element"> {{element.position}} </td>
                        </ng-container>

                        <!-- Name Column -->
                        <ng-container matColumnDef="Patient Name">
                            <th mat-header-cell *matHeaderCellDef class="f-18"> Name </th>
                            <td mat-cell *matCellDef="let element">

                                <img class="patient_img position-relative" height="30"
                                        src="https://img.icons8.com/external-konkapp-outline-color-konkapp/64/000000/external-patient-virus-transmission-konkapp-outline-color-konkapp.png" />
                                
                                {{element.patient_name}} </td>
                        </ng-container>

                        <!-- Weight Column -->
                        <ng-container matColumnDef="Patient Phone">
                            <th mat-header-cell *matHeaderCellDef class="f-18"> Phone </th>
                            <td mat-cell *matCellDef="let element"> {{element.patinet_phone}} </td>
                        </ng-container>

                        <!-- Symbol Column -->
                        <ng-container matColumnDef="Appointment Date">
                            <th mat-header-cell *matHeaderCellDef class="f-18"> Appointment Date </th>
                            <td mat-cell *matCellDef="let element"> {{element.appointment_date | date:'dd/MM/yy'}} </td>
                        </ng-container>

                        <ng-container matColumnDef="Appointment Time">
                            <th mat-header-cell *matHeaderCellDef class="f-18"> Time </th>
                            <td mat-cell *matCellDef="let element"> {{element.appointment_time}} </td>
                        </ng-container>


                        <ng-container matColumnDef="Status">
                            <th mat-header-cell *matHeaderCellDef class="f-18">Status </th>
                            <td mat-cell *matCellDef="let element"> {{element.appointment_status }}
                                <ng-container *ngIf="element.appointment_status == 'Open'" class="col">

                                    <a class="dropdown-toggle" role="button" id="dropdownMenuLink"
                                        [matMenuTriggerFor]="menu">

                                    </a>
                                    <mat-menu #menu="matMenu">
                                        <button mat-menu-item
                                            (click)="updateStatus(element._id,'Closed')">Close</button>
                                        <button mat-menu-item
                                            (click)="updateStatus(element._id,'Cancelled')">Cancel</button>
                                    </mat-menu>
                                </ng-container>
                            </td>
                        </ng-container>

                        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
                    </table>
                    <mat-paginator [pageSizeOptions]="[5, 10, 20]" showFirstLastButtons
                        aria-label="Select page of periodic elements">
                    </mat-paginator>
                </div>
            </div>



        </div>
    </div>
</div>